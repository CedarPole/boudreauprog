<!DOCTYPE html>
<head>
<link rel="script" href="scripts/event.js" />
<link rel="stylesheet" href="styles/event.css" />
<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
  
</head>
<body onload="loadPage()">
<div class="wrapper">
  <form id="myForm">
  MTV Submission Form!
    <div class="stage1">
    Please enter you're username and which stage you're submitting
    <div>Username : <input name="Username" required="true" type="text" /></div>
      <div>&nbsp;&nbsp;&nbsp;&nbsp;Event : 
        <select name="Events" id="ddEvents" onchange="setUnits()">
          <option>Select your Event</option>
        </select>
      </div>
    </div>



<div id="stage2">
  <div class="banned">Banned Units
    <div class="banportraits">
    <img src="styles/images/portraits/Jack Garland.webp" />
    <img src="styles/images/portraits/Hope.webp" />
    <img src="styles/images/portraits/Minwu.webp" />
    </div>
  </div>
  <div class="units">
    <fieldset class="unit">
      <legend>Unit 1</legend>
      <div>
        <select onchange="updateUnits(1)" name="Unit 1" id="ddUnit1"><option>Select Your Unit</option></select>
        <select name="Call 1" id="ddCall1"><option>Select Your Call</option></select>
        <div>BT Used? <input name="BT 1" type="checkbox" /> FR Used? <input name="FR 1" type="checkbox"></div>
      
      </div>

    </fieldset>
    <fieldset class="unit">
      <legend >Unit 2</legend>
      <select onchange="updateUnits(2)" name="Unit 2" id="ddUnit2"><option>Select Your Unit</option></select>
      <select name="Call 2" id="ddCall2"><option>Select Your Call</option></select>
      <div>BT Used? <input type="checkbox" name="BT 2" /> FR Used? <input name="FR 2" type="checkbox"></div>
    
    </fieldset>
    <fieldset class="unit">
      <legend>Unit 3</legend>
      <select onchange="updateUnits(3)" name="Unit 3" id="ddUnit3"><option>Select Your Unit</option></select>
      <select name="Call 3" id="ddCall3"><option>Select Your Call</option></select>
      <div>BT Used <input type="checkbox" name="BT 3" /> FR Used? <input name="FR 3" type="checkbox"></div>
    
    </fieldset>
  </div>
  <div class="turn">Turn Count <input name="Turn Count" type="text" /></div>
  <div>Video Link <input name="Video Link" type="text" /></div>
  <button onclick="SubForm()">Submit</button>
</div>
</div>

  
</div>
</form>
</div>
</body>
<script>
  // Model
  let text = '{"units" : [' + '{"name":"Ace","burst":true,"force":false},' + '{"name":"Aerith","burst":false,"force":true},' + 
		'{"name":"Agrias","burst":false,"force":false},' + '{"name":"Alisaie","burst":false,"force":false},' + '{"name":"Alphinaud","burst":false,"force":false},' +
		'{"name":"Amidatelion","burst":false,"force":false},' + ' {"name":"Aphmau","burst":false,"force":false},' + ' {"name":"Aranea","burst":false,"force":true},'
		+ ' {"name":"Arciela","burst":false,"force":false},' + ' {"name":"Ardyn","burst":true,"force":true},' + '{"name":"Ash","burst":false,"force":false}]}' ;
  const obj = JSON.parse(text)

  function loadPage()
{
  fetch('json/Units.json')
  .then((response) => response.json())
  .then((unitlist) => console.log(unitlist))
 fetch('json/events.json')
  .then((response) => response.json())
  .then((eventlist) => console.log(eventlist))
  
  setEvents()

}
// This is the form to submit to google docs
function SubForm () // This works
{
			$.ajax({
				url:"https://api.apispreadsheets.com/data/mwoVfMzsyT9PeR7M/",
				type:"post",
				data:$("#myForm").serializeArray(),
				success: function(){
					alert("Form Data Submitted :)")
				},
				error: function(){
					alert("There was an error :(")
				}
			});
		}

function setEvents()
{
  
  const d = new Date();
  let month = d.getMonth();
  const events = document.getElementById("ddEvents");
  let option = document.createElement("option");
  let option2 = document.createElement("option");
  let option3 = document.createElement("option");
  let option4 = document.createElement("option");
  let option5 = document.createElement("option");
  let option6 = document.createElement("option");
  if(month == 0) 
  {
    option.text = "Spiritus Ramuh";
    option2.text = "Sice Lost Chapter";
    option3.text = "Strago Heretics";
    option4.text = "DET 13";
    option5.text = "Kuja Interscting Wills";
    option6.text = "Jessie's Event";
  }
  
  events.add(option)
  events.add(option2);
  events.add(option3);
  events.add(option4);
  events.add(option5);
  events.add(option6);
}
function setUnits() //All done
{
  const value = document.getElementById("ddEvents").value
  const unit = document.getElementById("stage2")
  if(value != "Select your Event")
  {
    unit.style.visibility = "visible";
    updateban(value);
    
    popUnits();
  }
  else
  {
    unit.style.visibility = "hidden";
  }
}
function updateUnits(value)
{
  
  let selected = document.getElementById("ddUnit" + value)

  if(selected.value != "Select Your Unit")
  {
    if(value == 1)
  {
    console.log(selected.value)
    document.getElementById("ddUnit2").remove(selected.value)
  }
  }
}
function popUnits()
{
  console.log(obj.units.length)
  const unit1 = document.getElementById("ddUnit1")
  const unit2 = document.getElementById("ddUnit2")
  const unit3 = document.getElementById("ddUnit3")
  for(let i = 0; i < obj.units.length; i++)
  {
    
    let option = document.createElement("option");
    option.text = obj.units[i].name;
    unit1.add(option);
  }
  for(let i = 0; i < obj.units.length; i++)
  {
    
    let option = document.createElement("option");
    option.text = obj.units[i].name;
    unit2.add(option);
  }
  for(let i = 0; i < obj.units.length; i++)
  {
    
    let option = document.createElement("option");
    option.text = obj.units[i].name;
    unit3.add(option);
  }
  
  let banned = document.getElementById("lblbanned");
  banned.innerHTML = "wow";
}

function updateban(value)
{
  
}

	
</script>